(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{2936:(e,s,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(7964)}])},7964:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>C});var t=a(7876),n=a(4232);let i={rE:"1.0.3"};var l=a(4664),r=a(4287),c=a(3727),o=a(6856);a(863);let d=()=>(0,t.jsx)("svg",{className:"nav-icon w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),u=()=>(0,t.jsx)("svg",{className:"nav-icon w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v12a4 4 0 004 4h4a2 2 0 002-2V5z"})}),h=()=>(0,t.jsx)("svg",{className:"nav-icon w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),p=()=>(0,t.jsx)("svg",{className:"nav-icon w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.24 7.76a5.52 5.52 0 00-8.48-3.36A4.5 4.5 0 006 7.5c0 .39-.03.77-.08 1.14A5.5 5.5 0 005.5 12a5.5 5.5 0 0010.41 2.66A4.5 4.5 0 0019.5 12a4.5 4.5 0 00-1.76-3.74z"})}),m=()=>(0,t.jsxs)("svg",{className:"nav-icon w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),x=()=>(0,t.jsx)("svg",{className:"nav-icon w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})}),j=()=>(0,t.jsx)("svg",{className:"nav-icon w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),g=()=>(0,t.jsx)("svg",{className:"sidebar-icon-svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),v=()=>(0,t.jsx)("svg",{className:"sidebar-icon-svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),b=()=>(0,t.jsx)("svg",{className:"sidebar-icon-svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),y=()=>(0,t.jsx)("svg",{className:"sidebar-icon-svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),N=()=>(0,t.jsx)("svg",{className:"sidebar-icon-svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),w=e=>{let s={};return e.forEach(e=>{let a="".concat(e.chapter_id,"-").concat(e.chapter_name);s[a]||(s[a]={chapter_id:e.chapter_id,chapter_name:e.chapter_name,subject:e.subject,curriculum:e.curriculum,grade:e.grade,studyPlans:[],aggregatedStatus:"In Queue",totalTopics:0,completedTopics:0,inProgressTopics:0,averageProgress:0}),s[a].studyPlans.push(e),s[a].totalTopics++}),Object.values(s).forEach(e=>{let s=e.studyPlans,a={Done:s.filter(e=>"Done"===e.learning_status).length,"In Progress":s.filter(e=>"In Progress"===e.learning_status).length,"To Do":s.filter(e=>"To Do"===e.learning_status).length,"In Queue":s.filter(e=>"In Queue"===e.learning_status).length};e.completedTopics=a.Done,e.inProgressTopics=a["In Progress"],e.averageProgress=Math.round(s.reduce((e,s)=>e+(s.progress_percentage||0),0)/s.length),a["In Progress"]>0?e.aggregatedStatus="In Progress":a["To Do"]>0?e.aggregatedStatus="To Do":a.Done===e.totalTopics?e.aggregatedStatus="Done":e.aggregatedStatus="In Queue"}),Object.values(s)};function f(e){let{chapter:s,bucketColor:a,onEdit:n,onUpdateProgress:i,getStatusColor:r,getProficiencyColor:o}=e,{attributes:d,listeners:u,setNodeRef:h,transform:p,transition:m,isDragging:x}=(0,l.PM)({id:"chapter-".concat(s.chapter_id)}),j={transform:c.Ks.Translate.toString(p),transition:x?"none":"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",zIndex:x?1e3:"auto"},g=Math.round(s.completedTopics/s.totalTopics*100),v=s.studyPlans.map(e=>e.target_date).filter(e=>e).map(e=>new Date(e)).sort((e,s)=>e-s),b=v.length>0?v[0]:null,y=b?Math.ceil((b-new Date)/864e5):null;return(0,t.jsxs)("div",{ref:h,style:{...j,border:"none",backgroundColor:"rgba(255, 255, 255, 0.3)",boxShadow:"inset 0 2px 4px rgba(0, 0, 0, 0.1), 0 4px 8px rgba(0, 0, 0, 0.1)"},className:"chapter-card ".concat(x?"dragging":""," ").concat("In Queue"===s.aggregatedStatus?"backlog-card":""),onClick:e=>n(s,e),children:[(0,t.jsxs)("div",{className:"chapter-meta-top",children:[(0,t.jsx)("span",{className:"meta-id",children:s.chapter_id}),(0,t.jsx)("span",{className:"meta-subject",children:s.subject})]}),(0,t.jsx)("div",{className:"chapter-header",...d,...u,style:{cursor:x?"grabbing":"grab",background:"In Queue"===s.aggregatedStatus?"#f3f4f6":"linear-gradient(135deg, ".concat(r(s.aggregatedStatus),"20, ").concat(r(s.aggregatedStatus),"60)")},children:(0,t.jsx)("div",{className:"chapter-info",children:(0,t.jsx)("h4",{className:"chapter-title",onClick:e=>{e.stopPropagation()},children:s.chapter_name})})}),(0,t.jsxs)("div",{className:"chapter-content",children:[(0,t.jsx)("div",{className:"chapter-details-grid ".concat("In Queue"===s.aggregatedStatus?"backlog-grid":""),children:"In Queue"===s.aggregatedStatus?(0,t.jsxs)("div",{className:"detail-row",children:[(0,t.jsx)("span",{className:"detail-label",children:"Status:"}),(0,t.jsx)("span",{className:"status-badge",style:{color:r(s.aggregatedStatus)},children:s.aggregatedStatus}),b&&(0,t.jsx)("span",{className:"target-date-display ".concat(null!==y&&y<0?"overdue":null!==y&&y<=7?"urgent":""),children:null!==y?y<0?"⏰ ".concat(Math.abs(y)," days overdue"):"\uD83D\uDCC5 ".concat(y," days left"):"\uD83D\uDCC5 ".concat(new Date(b).toLocaleDateString())})]}):(0,t.jsxs)("div",{className:"detail-row",children:[(0,t.jsx)("span",{className:"detail-label",children:"Status:"}),(0,t.jsx)("span",{className:"status-badge",style:{color:r(s.aggregatedStatus)},children:s.aggregatedStatus})]})}),"In Queue"!==s.aggregatedStatus&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"chapter-stats-grid",children:[(0,t.jsxs)("div",{className:"stat-item",children:[(0,t.jsx)("span",{className:"stat-label",children:"Topics:"}),(0,t.jsx)("span",{className:"stat-value",children:s.totalTopics})]}),(0,t.jsxs)("div",{className:"stat-item",children:[(0,t.jsx)("span",{className:"stat-label",children:"Completed:"}),(0,t.jsx)("span",{className:"stat-value",children:s.completedTopics})]})]}),(0,t.jsxs)("div",{className:"chapter-progress",children:[(0,t.jsx)("div",{className:"progress-bar",children:(0,t.jsx)("div",{className:"progress-fill",style:{width:"".concat(g,"%"),backgroundColor:100===g?"#10b981":g>0?"#f59e0b":"#6b7280"}})}),(0,t.jsxs)("div",{className:"progress-info",children:[(0,t.jsx)("span",{className:"progress-label",children:"Progress"}),(0,t.jsxs)("span",{className:"progress-text",children:[g,"% Complete"]})]})]})]}),b&&"In Queue"!==s.aggregatedStatus&&(0,t.jsx)("div",{className:"chapter-target-date",children:(0,t.jsx)("span",{className:"target-date-display ".concat(null!==y&&y<0?"overdue":null!==y&&y<=7?"urgent":""),children:null!==y?y<0?"⏰ ".concat(Math.abs(y)," days overdue"):"\uD83D\uDCC5 ".concat(y," days left"):"\uD83D\uDCC5 ".concat(new Date(b).toLocaleDateString())})})]})]})}function k(e){let{bucket:s,chapters:a,onEditChapter:n,onUpdateProgress:i,getStatusColor:r,getProficiencyColor:c}=e,{setNodeRef:o,isOver:d}=(0,l.zM)({id:s.id}),u=a.filter(e=>e.aggregatedStatus===s.status);return(0,t.jsxs)("div",{ref:o,className:"bucket bg-gray-50 rounded-lg p-4 min-h-[500px] flex flex-col ".concat(d?"ring-2 ring-blue-500 bg-blue-50":""," ").concat((e=>{switch(e){case"Done":return"bucket-done";case"In Progress":return"bucket-in-progress";case"To Do":return"bucket-todo";case"In Queue":return"bucket-backlog";default:return""}})(s.status)),children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,t.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:[s.name," (",u.length,")"]})}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,t.jsxs)("div",{className:"space-y-3",children:[u.map(e=>(0,t.jsx)(f,{chapter:e,bucketColor:r(s.status),onEdit:n,onUpdateProgress:i,getStatusColor:r,getProficiencyColor:c},e.chapter_id)),0===u.length&&(0,t.jsxs)("div",{className:"flex items-center justify-center h-32 text-gray-500 text-sm border-2 border-dashed border-gray-300 rounded-lg",children:["No chapters in ",s.name.toLowerCase()]})]})})]})}function _(e){let{subject:s,onUpdate:a,getStatusColor:i,getProficiencyColor:l}=e,[r,c]=(0,n.useState)([]),[o,d]=(0,n.useState)(null),[u,h]=(0,n.useState)(""),[p,m]=(0,n.useState)(!0),x=[{key:"actions",label:"Actions",width:"120px",type:"actions",readonly:!0},{key:"unique_id",label:"Unique ID",width:"140px",type:"text",readonly:!0},{key:"curriculum",label:"Curriculum",width:"100px",type:"text"},{key:"grade",label:"Grade",width:"70px",type:"number"},{key:"subject",label:"Subject",width:"100px",type:"text"},{key:"chapter_id",label:"Chapter ID",width:"100px",type:"text"},{key:"chapter_name",label:"Chapter Name",width:"180px",type:"text"},{key:"topic_id",label:"Topic ID",width:"100px",type:"text"},{key:"topic",label:"Topic",width:"250px",type:"text"},{key:"target_date",label:"Target Date",width:"120px",type:"date"},{key:"learning_status",label:"Learning Status",width:"130px",type:"select",options:["In Queue","To Do","In Progress","Done","Closed"]},{key:"learning_stage",label:"Learning Stage",width:"130px",type:"select",options:["Initiated","Skimmed","Grasped","Practiced","Revised"]},{key:"learning_proficiency",label:"Proficiency",width:"110px",type:"select",options:["Novice","Competent","Expert","Master"]},{key:"progress_percentage",label:"Progress %",width:"100px",type:"number",min:0,max:100},{key:"notes",label:"Notes",width:"200px",type:"text"}];(0,n.useEffect)(()=>{j()},[s]);let j=async()=>{try{m(!0);let e=await fetch("/api/study-plan"),a=await e.json(),t=s?a.filter(e=>e.subject.toLowerCase()===s.name.toLowerCase()):a;c(t)}catch(e){console.error("Failed to fetch study plans:",e)}finally{m(!1)}},g=(e,s,a)=>{d({uniqueId:e,columnKey:s}),h(a||"")},v=async()=>{if(o){try{let e=x.find(e=>e.key===o.columnKey),s=u;"number"===e.type?s=parseInt(u)||0:"date"===e.type&&(s=u?new Date(u).toISOString():null);let t={[o.columnKey]:s};await fetch("/api/study-plan/".concat(o.uniqueId),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),c(e=>e.map(e=>e.unique_id===o.uniqueId?{...e,[o.columnKey]:s}:e)),a&&a()}catch(e){console.error("Failed to update study plan:",e)}d(null),h("")}},b=e=>{"Enter"===e.key?v():"Escape"===e.key&&(d(null),h(""))},y=async()=>{try{let e={curriculum:(null==s?void 0:s.name)||"JEE",grade:11,subject:(null==s?void 0:s.name)||"Mathematics",chapter_name:"New Chapter",topic:"New Topic",target_date:null,learning_status:"In Queue",learning_stage:"Initiated",learning_proficiency:"Novice",progress_percentage:0,notes:""},t=await fetch("/api/study-plan",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok){let e=await t.json();c(s=>[...s,e]),a&&a()}}catch(e){console.error("Failed to add row:",e)}},N=async e=>{if(confirm("Are you sure you want to delete this row?"))try{await fetch("/api/study-plan/".concat(e),{method:"DELETE"}),c(s=>s.filter(s=>s.unique_id!==e)),a&&a()}catch(e){console.error("Failed to delete row:",e)}},w=async e=>{try{let t={curriculum:(null==s?void 0:s.name)||"JEE",grade:11,subject:(null==s?void 0:s.name)||"Mathematics",chapter_id:"CH-".concat(Date.now()),chapter_name:"New Chapter",topic:"New Topic",target_date:null,learning_status:"In Queue",learning_stage:"Initiated",learning_proficiency:"Novice",progress_percentage:0,notes:""},n=await fetch("/api/study-plan",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(n.ok){let s=await n.json();c(a=>{let t=[...a];return t.splice(e,0,s),t}),a&&a()}}catch(e){console.error("Failed to insert row:",e)}};return p?(0,t.jsx)("div",{className:"study-plan-container",children:(0,t.jsx)("div",{className:"study-plan-header",children:(0,t.jsxs)("div",{className:"header-info",children:[(0,t.jsx)("h1",{children:s?"".concat(s.name," Study Plan"):"Complete Study Plan"}),(0,t.jsx)("p",{children:"Master curriculum management with comprehensive tracking"})]})})}):(0,t.jsx)("div",{className:"study-plan-container",children:(0,t.jsx)("div",{className:"excel-grid-container",children:(0,t.jsxs)("div",{className:"excel-grid",children:[(0,t.jsx)("div",{className:"grid-row header-row",children:x.map(e=>(0,t.jsx)("div",{className:"grid-cell header-cell",style:{width:e.width,minWidth:e.width},children:e.label},e.key))}),r.map(e=>(0,t.jsx)("div",{className:"grid-row data-row",children:x.map(s=>(0,t.jsxs)("div",{className:"grid-cell",style:{width:s.width,minWidth:s.width},children:["actions"===s.key&&(0,t.jsxs)("div",{className:"action-buttons",children:[(0,t.jsx)("button",{className:"action-btn add-btn",onClick:()=>w(r.indexOf(e)),title:"Insert row above",children:"+"}),(0,t.jsx)("button",{className:"action-btn delete-btn",onClick:()=>N(e.unique_id),title:"Delete row",children:"\xd7"})]}),"unique_id"===s.key&&(0,t.jsx)("span",{className:"readonly-cell",children:e.unique_id}),"curriculum"===s.key&&((null==o?void 0:o.uniqueId)===e.unique_id&&"curriculum"===o.columnKey?(0,t.jsx)("input",{type:"text",value:u,onChange:e=>h(e.target.value),onBlur:v,onKeyDown:b,autoFocus:!0,className:"grid-input"}):(0,t.jsx)("span",{className:"editable-cell",onClick:()=>g(e.unique_id,"curriculum",e.curriculum),children:e.curriculum})),"grade"===s.key&&((null==o?void 0:o.uniqueId)===e.unique_id&&"grade"===o.columnKey?(0,t.jsx)("input",{type:"number",value:u,onChange:e=>h(e.target.value),onBlur:v,onKeyDown:b,autoFocus:!0,className:"grid-input",min:"9",max:"12"}):(0,t.jsx)("span",{className:"editable-cell",onClick:()=>g(e.unique_id,"grade",e.grade.toString()),children:e.grade})),"subject"===s.key&&(0,t.jsx)("span",{className:"readonly-cell",children:e.subject}),"chapter_id"===s.key&&(0,t.jsx)("span",{className:"readonly-cell",children:e.chapter_id}),"chapter_name"===s.key&&((null==o?void 0:o.uniqueId)===e.unique_id&&"chapter_name"===o.columnKey?(0,t.jsx)("input",{type:"text",value:u,onChange:e=>h(e.target.value),onBlur:v,onKeyDown:b,autoFocus:!0,className:"grid-input"}):(0,t.jsx)("span",{className:"editable-cell",onClick:()=>g(e.unique_id,"chapter_name",e.chapter_name),children:e.chapter_name})),"topic_id"===s.key&&(0,t.jsx)("span",{className:"readonly-cell",children:e.topic_id}),"topic"===s.key&&((null==o?void 0:o.uniqueId)===e.unique_id&&"topic"===o.columnKey?(0,t.jsx)("input",{type:"text",value:u,onChange:e=>h(e.target.value),onBlur:v,onKeyDown:b,autoFocus:!0,className:"grid-input"}):(0,t.jsx)("span",{className:"editable-cell",onClick:()=>g(e.unique_id,"topic",e.topic),children:e.topic})),"target_date"===s.key&&((null==o?void 0:o.uniqueId)===e.unique_id&&"target_date"===o.columnKey?(0,t.jsx)("input",{type:"date",value:u,onChange:e=>h(e.target.value),onBlur:v,onKeyDown:b,autoFocus:!0,className:"grid-input"}):(0,t.jsx)("span",{className:"editable-cell",onClick:()=>g(e.unique_id,"target_date",e.target_date?new Date(e.target_date).toISOString().split("T")[0]:""),children:e.target_date?new Date(e.target_date).toLocaleDateString():""})),"learning_status"===s.key&&((null==o?void 0:o.uniqueId)===e.unique_id&&"learning_status"===o.columnKey?(0,t.jsx)("select",{value:u,onChange:e=>h(e.target.value),onBlur:v,onKeyDown:b,autoFocus:!0,className:"grid-select",children:s.options.map(e=>(0,t.jsx)("option",{value:e,children:e},e))}):(0,t.jsx)("span",{className:"status-badge",style:{backgroundColor:"".concat(i(e.learning_status),"20"),color:i(e.learning_status),borderColor:i(e.learning_status)},onClick:()=>g(e.unique_id,"learning_status",e.learning_status),children:e.learning_status})),"learning_stage"===s.key&&((null==o?void 0:o.uniqueId)===e.unique_id&&"learning_stage"===o.columnKey?(0,t.jsx)("select",{value:u,onChange:e=>h(e.target.value),onBlur:v,onKeyDown:b,autoFocus:!0,className:"grid-select",children:s.options.map(e=>(0,t.jsx)("option",{value:e,children:e},e))}):(0,t.jsx)("span",{className:"editable-cell",onClick:()=>g(e.unique_id,"learning_stage",e.learning_stage),children:e.learning_stage})),"learning_proficiency"===s.key&&((null==o?void 0:o.uniqueId)===e.unique_id&&"learning_proficiency"===o.columnKey?(0,t.jsx)("select",{value:u,onChange:e=>h(e.target.value),onBlur:v,onKeyDown:b,autoFocus:!0,className:"grid-select",children:s.options.map(e=>(0,t.jsx)("option",{value:e,children:e},e))}):(0,t.jsx)("span",{className:"proficiency-display",onClick:()=>g(e.unique_id,"learning_proficiency",e.learning_proficiency),children:(e=>{let s=(0,t.jsx)("svg",{className:"proficiency-star",fill:"currentColor",viewBox:"0 0 20 20",width:"16",height:"16",children:(0,t.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),a=(0,t.jsx)("svg",{className:"proficiency-award",fill:"currentColor",viewBox:"0 0 20 20",width:"20",height:"20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});switch(e){case"Novice":default:return(0,t.jsx)("div",{className:"proficiency-icons",children:s});case"Competent":return(0,t.jsxs)("div",{className:"proficiency-icons",children:[s,s,s]});case"Expert":return(0,t.jsxs)("div",{className:"proficiency-icons",children:[s,s,s,s,s]});case"Master":return(0,t.jsx)("div",{className:"proficiency-icons",children:a})}})(e.learning_proficiency)})),"progress_percentage"===s.key&&((null==o?void 0:o.uniqueId)===e.unique_id&&"progress_percentage"===o.columnKey?(0,t.jsx)("input",{type:"number",value:u,onChange:e=>h(e.target.value),onBlur:v,onKeyDown:b,autoFocus:!0,className:"grid-input",min:"0",max:"100"}):(0,t.jsxs)("span",{className:"editable-cell",onClick:()=>g(e.unique_id,"progress_percentage",e.progress_percentage.toString()),children:[e.progress_percentage,"%"]})),"notes"===s.key&&((null==o?void 0:o.uniqueId)===e.unique_id&&"notes"===o.columnKey?(0,t.jsx)("input",{type:"text",value:u,onChange:e=>h(e.target.value),onBlur:v,onKeyDown:b,autoFocus:!0,className:"grid-input"}):(0,t.jsx)("span",{className:"editable-cell",onClick:()=>g(e.unique_id,"notes",e.notes||""),children:e.notes||""}))]},"".concat(e.unique_id,"-").concat(s.key)))},e.unique_id)),(0,t.jsx)("div",{className:"grid-row add-row",children:x.map(e=>(0,t.jsxs)("div",{className:"grid-cell",style:{width:e.width,minWidth:e.width},children:["actions"===e.key&&(0,t.jsx)("button",{className:"action-btn add-btn primary",onClick:y,title:"Add new row",children:"+"}),"actions"!==e.key&&(0,t.jsx)("span",{className:"add-placeholder",children:"Click + to add"})]},"add-".concat(e.key)))})]})})})}function C(){let[e,s]=(0,n.useState)([]),[a,c]=(0,n.useState)([]),[f,C]=(0,n.useState)(null),[S,D]=(0,n.useState)(!0),[P,T]=(0,n.useState)(null),[M,L]=(0,n.useState)(null),[q,I]=(0,n.useState)(null),[z,E]=(0,n.useState)([]),[B,F]=(0,n.useState)([]),[A,O]=(0,n.useState)(""),[K,W]=(0,n.useState)("All"),[V,R]=(0,n.useState)("All"),[J,U]=(0,n.useState)(null),[Q,G]=(0,n.useState)("ocean"),[H,Z]=(0,n.useState)("default"),[X,Y]=(0,n.useState)("kanban"),[$,ee]=(0,n.useState)([]),[es,ea]=(0,n.useState)(!1),[et,en]=(0,n.useState)(!1),[ei,el]=(0,n.useState)("zen-mixed"),[er,ec]=(0,n.useState)(.2),[eo,ed]=(0,n.useState)(!0),[eu,eh]=(0,n.useState)(!0),[ep,em]=(0,n.useState)(null),[ex,ej]=(0,n.useState)({top:0,left:0}),[eg,ev]=(0,n.useState)([]),[eb,ey]=(0,n.useState)(""),[eN,ew]=(0,n.useState)([]),[ef,ek]=(0,n.useState)(!1),[e_,eC]=(0,n.useState)(null),[eS,eD]=(0,n.useState)(!0),eP=e=>({"In Queue":"#6b7280","To Do":"#3b82f6","In Progress":"#f59e0b",Done:"#10b981",Closed:"#8b5cf6"})[e]||"#6b7280",eT=e=>({Novice:"#ef4444",Competent:"#f59e0b",Expert:"#3b82f6",Master:"#10b981"})[e]||"#6b7280",eM=(0,l.FR)((0,l.MS)(l.AN),(0,l.MS)(l.uN,{coordinateGetter:r.JR})),eL=[{id:"backlog",name:"Backlog",status:"In Queue"},{id:"todo",name:"To Do",status:"To Do"},{id:"inprogress",name:"In Progress",status:"In Progress"},{id:"done",name:"Done",status:"Done"}];(0,n.useEffect)(()=>{eq()},[]),(0,n.useEffect)(()=>{document.body.className="bg-".concat(Q)},[Q]),(0,n.useEffect)(()=>{if(eu&&eo){let e=setInterval(()=>{let e=["zen-mixed","zen-forest","zen-rain","zen-wind","zen-birds","zen-water"],s=(e.indexOf(ei)+1)%e.length;el(e[s])},18e5);return()=>clearInterval(e)}},[eu,eo,ei]);let eq=async()=>{try{let e=await fetch("/api/study-plan"),a=await e.json(),t=[...new Set(a.map(e=>e.subject))].map((e,s)=>({subject_id:s+1,name:e,Chapters:[]}));s([]),c(t),ee(a),t.length>0&&C(t[0]),D(!1)}catch(e){console.error("Failed to fetch data:",e),D(!1)}},eI=async()=>{if(confirm("Are you sure you want to delete ALL study plan cards? This action cannot be undone."))try{let e=await fetch("/api/study-plan"),s=(await e.json()).map(e=>fetch("/api/study-plan/".concat(e.unique_id),{method:"DELETE"}));await Promise.all(s),ee([]),alert("All study plan cards have been deleted successfully.")}catch(e){console.error("Failed to delete all cards:",e),alert("Failed to delete all cards. Please try again.")}},ez=async e=>{let{active:s,over:a}=e;if(!a)return;let t=s.id,n=a.id;if(t.startsWith("chapter-")){let e=t.replace("chapter-",""),s=eL.find(e=>e.id===n);if(s){let a=document.querySelector('[data-id="'.concat(t,'"]'));a&&(a.classList.add("dropping"),setTimeout(()=>{a.classList.remove("dropping")},600));try{let a=w($.filter(e=>e.subject===f.name)).find(s=>s.chapter_id===e);if(a){let e=a.studyPlans.map(e=>fetch("/api/study-plan/".concat(e.unique_id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({learning_status:s.status})}));await Promise.all(e),eq()}}catch(e){console.error("Failed to update chapter:",e)}}}},eE=async(e,s)=>{T(e)},eB=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0}),s=new MediaRecorder(e),a=[];s.ondataavailable=e=>{e.data.size>0&&a.push(e.data)},s.onstop=()=>{let s=new Blob(a,{type:"audio/wav"}),t=URL.createObjectURL(s),n={id:Date.now(),url:t,blob:s,timestamp:new Date().toLocaleString()};ew([...eN,n]),e.getTracks().forEach(e=>e.stop())},eC(s),s.start(),ek(!0)}catch(e){console.error("Error starting recording:",e),alert("Could not access microphone. Please check permissions.")}};return S?(0,t.jsx)("div",{children:"Loading..."}):(0,t.jsxs)("div",{className:"planner",children:[(0,t.jsx)("nav",{className:"top-navbar navbar-".concat(H||"default"),children:(0,t.jsxs)("div",{className:"navbar-content",children:[(0,t.jsxs)("div",{className:"navbar-brand",children:[(0,t.jsxs)("div",{className:"brand-logo",children:[(0,t.jsx)("span",{className:"brand-main",children:"Prody"}),(0,t.jsx)("span",{className:"brand-jee",children:"JEE"}),(0,t.jsx)("span",{className:"brand-accent",children:"™"})]}),(0,t.jsxs)("div",{className:"brand-subtitle",children:[(0,t.jsx)("span",{children:"Peepal Prodigy School"}),(0,t.jsxs)("span",{className:"version-tag",children:["v",i.rE]})]})]}),f&&"kanban"===X&&(0,t.jsx)("div",{className:"navbar-center",children:(0,t.jsxs)("h3",{className:"navbar-title",children:["Kanban Board - ",f.name," (",w($.filter(e=>e.subject===f.name)).length," chapters)"]})}),(0,t.jsxs)("div",{className:"navbar-actions",children:[(0,t.jsx)("button",{className:"nav-action-btn",onClick:()=>en(!0),title:"Settings",children:(0,t.jsx)(m,{})}),(0,t.jsx)("button",{className:"nav-action-btn",onClick:()=>{},title:"Themes",children:(0,t.jsx)(u,{})}),(0,t.jsx)("a",{href:"/login",className:"nav-action-btn user-profile",title:"User Profile",children:(0,t.jsx)(j,{})})]})]})}),(0,t.jsx)("div",{className:"horizontal-navbar",children:(0,t.jsxs)("div",{className:"nav-content",children:[(0,t.jsx)("div",{className:"breadcrumb-section",children:(0,t.jsxs)("div",{className:"breadcrumb-path",children:[(0,t.jsx)("span",{className:"breadcrumb-item",children:"Home"}),(0,t.jsx)("span",{className:"breadcrumb-separator",children:"/"}),(0,t.jsx)("span",{className:"breadcrumb-item active",children:"Study Plans"}),f&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"breadcrumb-separator",children:"/"}),(0,t.jsx)("span",{className:"breadcrumb-item active",children:f.name})]})]})}),(0,t.jsxs)("div",{className:"filter-tabs-section",children:[(0,t.jsx)("div",{className:"filter-group",children:(0,t.jsx)("div",{className:"filter-tabs",children:a.slice(0,4).map(e=>(0,t.jsxs)("button",{className:"filter-tab ".concat((null==f?void 0:f.subject_id)===e.subject_id?"active":""),onClick:()=>C(e),children:[(0,t.jsx)(d,{}),(0,t.jsx)("span",{children:e.name})]},e.subject_id))})}),(0,t.jsx)("div",{className:"filter-group",children:(0,t.jsxs)("div",{className:"view-toggle-tabs",children:[(0,t.jsxs)("button",{className:"view-tab ".concat("kanban"===X?"active":""),onClick:()=>Y("kanban"),title:"Kanban View",children:[(0,t.jsx)(d,{}),(0,t.jsx)("span",{children:"Kanban"})]}),(0,t.jsxs)("button",{className:"view-tab ".concat("study-plan"===X?"active":""),onClick:()=>Y("study-plan"),title:"Study Plan View",children:[(0,t.jsx)(h,{}),(0,t.jsx)("span",{children:"Study Plan"})]})]})})]})]})}),(0,t.jsxs)("div",{className:"sidebar ".concat(eS?"collapsed":"expanded"),children:[(0,t.jsx)("div",{className:"sidebar-header",children:(0,t.jsx)("button",{className:"sidebar-toggle",onClick:()=>eD(!eS),title:eS?"Expand Sidebar":"Collapse Sidebar",children:eS?"☰":"✕"})}),(0,t.jsxs)("div",{className:"sidebar-content",children:[(0,t.jsxs)("div",{className:"sidebar-item",title:"Dashboard",children:[(0,t.jsx)(g,{}),!eS&&(0,t.jsx)("span",{children:"Dashboard"})]}),(0,t.jsxs)("div",{className:"sidebar-item",title:"Charts",children:[(0,t.jsx)(v,{}),!eS&&(0,t.jsx)("span",{children:"Charts"})]}),(0,t.jsxs)("div",{className:"sidebar-item",title:"Schedule",children:[(0,t.jsx)(b,{}),!eS&&(0,t.jsx)("span",{children:"Schedule"})]}),(0,t.jsxs)("div",{className:"sidebar-item",title:"Timer",children:[(0,t.jsx)(y,{}),!eS&&(0,t.jsx)("span",{children:"Timer"})]}),(0,t.jsxs)("div",{className:"sidebar-item",title:"Relax",children:[(0,t.jsx)(N,{}),!eS&&(0,t.jsx)("span",{children:"Relax"})]})]}),(0,t.jsx)("div",{className:"sidebar-footer",children:!eS&&(0,t.jsx)("div",{className:"sidebar-attribution",children:"by Sasha Nagarajan, 11th Grade, Peepal Prodigy School, Madukkarai, Coimbatore"})})]}),(0,t.jsxs)("main",{className:"board",children:[f&&"kanban"===X&&(0,t.jsx)(l.Mp,{sensors:eM,collisionDetection:l.y$,onDragEnd:ez,children:(0,t.jsx)("div",{className:"kanban-board",children:(0,t.jsx)("div",{className:"buckets-container",children:eL.map(e=>(0,t.jsx)(k,{bucket:e,chapters:w($.filter(e=>e.subject===f.name)),onEditChapter:eE,onUpdateProgress:eq,getStatusColor:eP,getProficiencyColor:eT},e.id))})})}),f&&"study-plan"===X&&(0,t.jsx)(_,{subject:f,onUpdate:eq,getStatusColor:eP,getProficiencyColor:eT})]}),(0,t.jsxs)(t.Fragment,{children:[M&&(0,t.jsx)("div",{className:"modal-overlay",children:(0,t.jsxs)("div",{className:"task-modal",children:[(0,t.jsxs)("div",{className:"modal-header",children:[(0,t.jsx)("h2",{children:M.title}),(0,t.jsx)("button",{className:"close-btn",onClick:()=>L(null),children:"\xd7"})]}),(0,t.jsxs)("div",{className:"modal-body",children:[(0,t.jsx)("div",{className:"task-details",children:(0,t.jsxs)("form",{onSubmit:async e=>{e.preventDefault();let s=new FormData(e.target);await fetch("/api/tasks/".concat(M.task_id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:s.get("title"),description:s.get("description"),priority:s.get("priority"),progress:parseInt(s.get("progress")),due_date:J})}),L(null),fetchPlans()},children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Title"}),(0,t.jsx)("input",{name:"title",defaultValue:M.title,required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Description"}),(0,t.jsx)("textarea",{name:"description",defaultValue:M.description,rows:"3"})]}),(0,t.jsxs)("div",{className:"form-row",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Priority"}),(0,t.jsxs)("select",{name:"priority",defaultValue:M.priority,children:[(0,t.jsx)("option",{children:"Low"}),(0,t.jsx)("option",{children:"Medium"}),(0,t.jsx)("option",{children:"High"}),(0,t.jsx)("option",{children:"Important"})]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Progress (%)"}),(0,t.jsx)("input",{name:"progress",type:"number",min:"0",max:"100",defaultValue:M.progress})]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Due Date"}),(0,t.jsx)(o.Ay,{selected:J,onChange:U,dateFormat:"yyyy-MM-dd",placeholderText:"Select due date"})]}),(0,t.jsxs)("div",{className:"form-actions",children:[(0,t.jsx)("button",{type:"submit",className:"save-btn",children:"Save Changes"}),(0,t.jsx)("button",{type:"button",onClick:()=>L(null),className:"cancel-btn",children:"Cancel"})]})]})}),(0,t.jsxs)("div",{className:"task-sections",children:[(0,t.jsxs)("div",{className:"section",children:[(0,t.jsx)("h4",{children:"Subtasks"}),(0,t.jsx)("div",{className:"subtasks-list",children:B.map(e=>(0,t.jsxs)("div",{className:"subtask-item",children:[(0,t.jsx)("input",{type:"checkbox",checked:e.completed,onChange:async s=>{await fetch("/api/subtasks",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({subtask_id:e.subtask_id,completed:s.target.checked})});let a=await fetch("/api/subtasks?task_id=".concat(M.task_id));F(await a.json())}}),(0,t.jsx)("span",{className:e.completed?"completed":"",children:e.title})]},e.subtask_id))}),(0,t.jsx)("form",{onSubmit:async e=>{e.preventDefault();let s=new FormData(e.target);await fetch("/api/subtasks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({task_id:M.task_id,title:s.get("subtask")})}),e.target.reset();let a=await fetch("/api/subtasks?task_id=".concat(M.task_id));F(await a.json())},children:(0,t.jsxs)("div",{className:"add-item",children:[(0,t.jsx)("input",{name:"subtask",placeholder:"Add a subtask...",required:!0}),(0,t.jsx)("button",{type:"submit",children:"+"})]})})]}),(0,t.jsxs)("div",{className:"section",children:[(0,t.jsx)("h4",{children:"Comments"}),(0,t.jsx)("div",{className:"comments-list",children:z.map(e=>(0,t.jsxs)("div",{className:"comment-item",children:[(0,t.jsx)("p",{children:e.content}),(0,t.jsx)("small",{children:new Date(e.created_at).toLocaleString()})]},e.comment_id))}),(0,t.jsx)("form",{onSubmit:async e=>{e.preventDefault();let s=new FormData(e.target);await fetch("/api/comments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({task_id:M.task_id,content:s.get("comment")})}),e.target.reset();let a=await fetch("/api/comments?task_id=".concat(M.task_id));E(await a.json())},children:(0,t.jsxs)("div",{className:"add-item",children:[(0,t.jsx)("textarea",{name:"comment",placeholder:"Add a comment...",required:!0,rows:"2"}),(0,t.jsx)("button",{type:"submit",children:"Comment"})]})})]})]})]})]})}),P&&(0,t.jsx)("div",{className:"modal-overlay",children:(0,t.jsxs)("div",{className:"chapter-modal glass-card",children:[(0,t.jsxs)("div",{className:"modal-header",children:[(0,t.jsxs)("h2",{children:["Chapter: ",P.chapter_name]}),(0,t.jsx)("button",{className:"close-btn",onClick:()=>T(null),children:"\xd7"})]}),(0,t.jsxs)("div",{className:"modal-body",children:[(0,t.jsx)("div",{className:"topics-scrollable-container",children:(0,t.jsxs)("div",{className:"topics-section",children:[(0,t.jsx)("h3",{children:"Topics in this Chapter"}),(0,t.jsx)("div",{className:"topics-list",children:P.studyPlans.map(e=>(0,t.jsx)("div",{className:"topic-item-detailed",children:(0,t.jsxs)("div",{className:"topic-header",children:[(0,t.jsxs)("div",{className:"topic-info",children:[(0,t.jsxs)("div",{className:"topic-completion",children:[(0,t.jsxs)("div",{className:"progress-stages",children:[(0,t.jsxs)("label",{className:"stage-option",children:[(0,t.jsx)("input",{type:"radio",name:"progress-".concat(e.unique_id),value:"Started",checked:"Started"===e.learning_status||"Studied"===e.learning_status||"Done"===e.learning_status,onChange:async s=>{try{await fetch("/api/study-plan",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({unique_id:e.unique_id,learning_status:"Started",progress_percentage:33})}),await eq();let s=w($.filter(e=>e.subject===(null==f?void 0:f.name))).find(e=>e.chapter_id===P.chapter_id);s&&T(s)}catch(e){console.error("Failed to update topic status:",e)}}}),(0,t.jsx)("span",{className:"stage-label",children:"Started"})]}),(0,t.jsxs)("label",{className:"stage-option",children:[(0,t.jsx)("input",{type:"radio",name:"progress-".concat(e.unique_id),value:"Studied",checked:"Studied"===e.learning_status||"Done"===e.learning_status,onChange:async s=>{try{await fetch("/api/study-plan",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({unique_id:e.unique_id,learning_status:"Studied",progress_percentage:66})}),await eq();let s=w($.filter(e=>e.subject===(null==f?void 0:f.name))).find(e=>e.chapter_id===P.chapter_id);s&&T(s)}catch(e){console.error("Failed to update topic status:",e)}}}),(0,t.jsx)("span",{className:"stage-label",children:"Studied"})]}),(0,t.jsxs)("label",{className:"stage-option",children:[(0,t.jsx)("input",{type:"radio",name:"progress-".concat(e.unique_id),value:"Practiced",checked:"Done"===e.learning_status,onChange:async s=>{try{await fetch("/api/study-plan",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({unique_id:e.unique_id,learning_status:"Done",progress_percentage:100})}),await eq();let s=w($.filter(e=>e.subject===(null==f?void 0:f.name))).find(e=>e.chapter_id===P.chapter_id);s&&T(s)}catch(e){console.error("Failed to update topic status:",e)}}}),(0,t.jsx)("span",{className:"stage-label",children:"Practiced"})]})]}),(0,t.jsx)("h4",{className:"topic-title ".concat("Done"===e.learning_status?"completed":""),children:e.topic})]}),(0,t.jsxs)("div",{className:"topic-meta",children:[(0,t.jsxs)("span",{className:"topic-id",children:["ID: ",e.topic_id]}),(0,t.jsx)("span",{className:"status-badge",style:{backgroundColor:"".concat(eP(e.learning_status),"30"),color:eP(e.learning_status),border:"1px solid ".concat(eP(e.learning_status))},children:e.learning_status})]})]}),(0,t.jsxs)("div",{className:"topic-progress",children:[(0,t.jsxs)("span",{className:"progress-value",children:[e.progress_percentage,"%"]}),(0,t.jsx)("div",{className:"mini-progress-bar",children:(0,t.jsx)("div",{className:"mini-progress-fill",style:{width:"".concat(e.progress_percentage,"%"),backgroundColor:100===e.progress_percentage?"#10b981":e.progress_percentage>0?"#f59e0b":"#6b7280"}})})]})]})},e.unique_id))})]})}),(0,t.jsxs)("div",{className:"modal-bottom-sections",children:[(0,t.jsx)("h3",{children:"Notes"}),(0,t.jsx)("textarea",{placeholder:"Add notes for this chapter...",rows:"6",className:"notes-textarea",value:P.notes||"",onChange:e=>{T({...P,notes:e.target.value})}})]}),(0,t.jsxs)("div",{className:"voice-section",children:[(0,t.jsx)("h3",{children:"Voice Recording"}),(0,t.jsxs)("div",{className:"voice-controls",children:[(0,t.jsx)("button",{className:"voice-btn",title:"Start Recording",children:(0,t.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,t.jsx)("circle",{cx:"12",cy:"12",r:"4",fill:"currentColor"})]})}),(0,t.jsx)("button",{className:"voice-btn",title:"Stop Recording",children:(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("rect",{x:"6",y:"6",width:"12",height:"12",stroke:"currentColor",strokeWidth:"2"})})}),(0,t.jsx)("button",{className:"voice-btn",title:"Play Recording",children:(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("polygon",{points:"8,5 19,12 8,19",stroke:"currentColor",strokeWidth:"2",fill:"currentColor"})})})]})]})]})]})}),q&&(0,t.jsx)("div",{className:"modal",children:(0,t.jsxs)("div",{className:"modal-content",children:[(0,t.jsx)("h3",{children:"Add New Task"}),(0,t.jsxs)("form",{onSubmit:async e=>{e.preventDefault();let s=new FormData(e.target);await fetch("/api/tasks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bucket_id:q,title:s.get("title"),description:s.get("description"),priority:s.get("priority"),progress:0})}),I(null),fetchPlans()},children:[(0,t.jsx)("input",{name:"title",placeholder:"Task title",required:!0}),(0,t.jsx)("textarea",{name:"description",placeholder:"Description"}),(0,t.jsxs)("select",{name:"priority",children:[(0,t.jsx)("option",{children:"Low"}),(0,t.jsx)("option",{children:"Medium"}),(0,t.jsx)("option",{children:"High"}),(0,t.jsx)("option",{children:"Important"})]}),(0,t.jsx)("button",{type:"submit",children:"Add Task"}),(0,t.jsx)("button",{type:"button",onClick:()=>I(null),children:"Cancel"})]})]})})]}),es&&(0,t.jsx)("div",{className:"weather-overlay",children:Array.from({length:50},(e,s)=>(0,t.jsx)("div",{className:"raindrop",style:{left:"".concat(100*Math.random(),"%"),animationDelay:"".concat(2*Math.random(),"s"),animationDuration:"".concat(1+Math.random(),"s")}},s))}),"none"!==ei&&(0,t.jsxs)("audio",{ref:e=>{e&&(e.volume=er,eo?e.play().catch(s=>{console.log("Audio play failed:",s);let a=()=>{e.play().catch(()=>{}),document.removeEventListener("click",a)};document.addEventListener("click",a)}):e.pause())},loop:!0,autoPlay:!0,preload:"auto",children:[(0,t.jsx)("source",{src:"zen-mixed"===ei?"https://www.soundjay.com/misc/sounds/ambient-nature.wav":"zen-forest"===ei?"https://www.soundjay.com/misc/sounds/forest-sounds.wav":"zen-rain"===ei?"https://www.soundjay.com/misc/sounds/rain-03.wav":"zen-wind"===ei?"https://www.soundjay.com/misc/sounds/wind.wav":"zen-birds"===ei?"https://www.soundjay.com/misc/sounds/birds-01.wav":"zen-water"===ei?"https://www.soundjay.com/misc/sounds/water-stream.wav":"meditation"===ei?"https://www.soundjay.com/misc/sounds/bell-ringing-05.wav":"flute"===ei?"https://www.soundjay.com/misc/sounds/flute.wav":"https://www.soundjay.com/misc/sounds/nature-sounds.wav",type:"audio/wav"}),(0,t.jsx)("source",{src:"zen-mixed"===ei?"https://www.soundjay.com/misc/sounds/ambient-nature.mp3":"zen-forest"===ei?"https://www.soundjay.com/misc/sounds/forest-sounds.mp3":"zen-rain"===ei?"https://www.soundjay.com/misc/sounds/rain-03.mp3":"zen-wind"===ei?"https://www.soundjay.com/misc/sounds/wind.mp3":"zen-birds"===ei?"https://www.soundjay.com/misc/sounds/birds-01.mp3":"zen-water"===ei?"https://www.soundjay.com/misc/sounds/water-stream.mp3":"meditation"===ei?"https://www.soundjay.com/misc/sounds/bell-ringing-05.mp3":"flute"===ei?"https://www.soundjay.com/misc/sounds/flute.mp3":"https://www.soundjay.com/misc/sounds/nature-sounds.mp3",type:"audio/mpeg"}),"Your browser does not support the audio element."]},ei),ep&&(0,t.jsx)("div",{className:"modal-overlay",children:(0,t.jsxs)("div",{className:"study-plan-modal glass-card",children:[(0,t.jsxs)("div",{className:"modal-header",children:[(0,t.jsxs)("div",{className:"modal-title-section",children:[(0,t.jsx)("h2",{children:ep.topic}),(0,t.jsxs)("div",{className:"study-plan-details-popup",children:[(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Chapter:"}),(0,t.jsx)("span",{className:"detail-value",children:ep.chapter_name})]}),(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Subject:"}),(0,t.jsx)("span",{className:"detail-value",children:ep.subject})]}),(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Grade:"}),(0,t.jsx)("span",{className:"detail-value",children:ep.grade})]}),(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("span",{className:"detail-label",children:"Curriculum:"}),(0,t.jsx)("span",{className:"detail-value",children:ep.curriculum})]})]}),(0,t.jsx)("span",{className:"modal-status-badge",style:{backgroundColor:"".concat(eP(ep.learning_status),"20"),color:eP(ep.learning_status),borderColor:eP(ep.learning_status)},children:ep.learning_status})]}),(0,t.jsx)("button",{className:"close-btn",onClick:()=>em(null),children:"\xd7"})]}),(0,t.jsx)("div",{className:"modal-body",children:(0,t.jsxs)("form",{onSubmit:async e=>{e.preventDefault();let s=new FormData(e.target);for(let e of eg)await fetch("/api/subtopics/".concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:e.completed?"Completed":"Not Started"})});let a=eg.filter(e=>e.completed).length,t=eg.length,n=t>0?Math.round(a/t*100):0;await fetch("/api/study-plan/".concat(ep.unique_id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({progress_percentage:n,notes:s.get("notes")})}),em(null),ev([]),ey(""),ew([]),fetchStudyPlans()},children:[(0,t.jsxs)("div",{className:"form-group primary-section",children:[(0,t.jsx)("label",{className:"form-label-icon",children:"� Chapter Sub-Topics"}),(0,t.jsxs)("div",{className:"progress-tracker",children:[(0,t.jsxs)("div",{className:"progress-header",children:[(0,t.jsx)("span",{className:"progress-title",children:"Overall Progress"}),(0,t.jsxs)("span",{className:"progress-percentage",children:[eg.length>0?Math.round(eg.filter(e=>e.completed).length/eg.length*100):0,"%"]})]}),(0,t.jsx)("div",{className:"progress-bar-container",children:(0,t.jsx)("div",{className:"progress-bar-fill",style:{width:"".concat(eg.length>0?Math.round(eg.filter(e=>e.completed).length/eg.length*100):0,"%")}})}),(0,t.jsxs)("div",{className:"progress-stats",children:[eg.filter(e=>e.completed).length," of ",eg.length," topics completed"]})]}),(0,t.jsxs)("div",{className:"subtopics-modern",children:[eg.map((e,s)=>(0,t.jsxs)("div",{className:"subtopic-item ".concat(e.completed?"completed":"pending"),children:[(0,t.jsxs)("div",{className:"subtopic-content",children:[(0,t.jsx)("div",{className:"subtopic-icon",children:e.completed?"✓":"○"}),(0,t.jsx)("span",{className:"subtopic-text",children:e.text})]}),(0,t.jsxs)("div",{className:"subtopic-actions",children:[(0,t.jsx)("button",{type:"button",className:"status-btn ".concat(e.completed?"completed":"pending"),onClick:()=>{let e=[...eg];e[s].completed=!e[s].completed,ev(e)},children:e.completed?"Mark Incomplete":"Mark Complete"}),(0,t.jsx)("button",{type:"button",className:"remove-subtopic-btn",onClick:()=>{ev(eg.filter((e,a)=>a!==s))},children:"\xd7"})]})]},e.id)),(0,t.jsxs)("div",{className:"add-subtopic-modern",children:[(0,t.jsx)("input",{type:"text",value:eb,onChange:e=>ey(e.target.value),placeholder:"Add new learning topic...",onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),eb.trim()&&(ev([...eg,{id:Date.now(),text:eb.trim(),completed:!1}]),ey("")))}}),(0,t.jsx)("button",{type:"button",className:"add-subtopic-btn-modern",onClick:()=>{eb.trim()&&(ev([...eg,{id:Date.now(),text:eb.trim(),completed:!1}]),ey(""))},children:"+ Add Topic"})]})]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label-icon",children:"\uD83D\uDCDD Notes"}),(0,t.jsx)("textarea",{name:"notes",defaultValue:ep.notes,rows:"4",placeholder:"Add your study notes, insights, or reminders here..."})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label-icon",children:"�️ Voice Notes"}),(0,t.jsxs)("div",{className:"voice-logging",children:[(0,t.jsx)("div",{className:"voice-controls",children:ef?(0,t.jsx)("button",{type:"button",className:"record-btn stop",onClick:()=>{e_&&ef&&(e_.stop(),ek(!1),eC(null))},children:"⏹️ Stop Recording"}):(0,t.jsx)("button",{type:"button",className:"record-btn recording",onClick:eB,children:"�️ Start Recording"})}),(0,t.jsx)("div",{className:"voice-recordings",children:0===eN.length?(0,t.jsx)("p",{children:"No voice recordings yet"}):eN.map(e=>(0,t.jsxs)("div",{className:"voice-recording-item",children:[(0,t.jsxs)("span",{children:["Recording ",new Date(e.timestamp).toLocaleTimeString()]}),(0,t.jsxs)("div",{className:"recording-controls",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{new Audio(e.url).play()},children:"▶️"}),(0,t.jsx)("button",{type:"button",onClick:()=>{var s;return s=e.id,void ew(eN.filter(e=>e.id!==s))},children:"\uD83D\uDDD1️"})]})]},e.id))})]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"form-label-icon",children:"\uD83D\uDCCA Overall Status & Date"}),(0,t.jsxs)("div",{className:"status-date-section",children:[(0,t.jsxs)("div",{className:"status-info",children:[(0,t.jsx)("span",{className:"status-label",children:"Current Status:"}),(0,t.jsx)("span",{className:"status-value",children:ep.learning_status})]}),(0,t.jsxs)("div",{className:"date-info",children:[(0,t.jsx)("span",{className:"date-label",children:"Target Date:"}),(0,t.jsx)("span",{className:"date-value",children:ep.target_date?new Date(ep.target_date).toLocaleDateString():"Not set"})]})]})]}),(0,t.jsxs)("div",{className:"form-actions",children:[(0,t.jsx)("button",{type:"submit",className:"save-btn",children:"\uD83D\uDCBE Save Progress"}),(0,t.jsx)("button",{type:"button",onClick:()=>{em(null),ev([]),ey(""),ew([])},className:"cancel-btn",children:"❌ Close"})]})]})})]})}),et&&(0,t.jsx)("div",{className:"modal-overlay",children:(0,t.jsxs)("div",{className:"settings-modal glass-card",children:[(0,t.jsxs)("div",{className:"modal-header",children:[(0,t.jsx)("h2",{children:"Settings"}),(0,t.jsx)("button",{className:"close-btn",onClick:()=>en(!1),children:"\xd7"})]}),(0,t.jsxs)("div",{className:"modal-body",children:[(0,t.jsxs)("div",{className:"settings-section",children:[(0,t.jsx)("h3",{children:"Background Theme"}),(0,t.jsxs)("div",{className:"setting-item",children:[(0,t.jsx)(u,{}),(0,t.jsxs)("select",{value:Q,onChange:e=>G(e.target.value),children:[(0,t.jsx)("option",{value:"forest-mountain",children:"Forest Mountain"}),(0,t.jsx)("option",{value:"green-forest",children:"Green Forest"}),(0,t.jsx)("option",{value:"bamboo",children:"Bamboo Grove"}),(0,t.jsx)("option",{value:"jungle",children:"Tropical Jungle"}),(0,t.jsx)("option",{value:"meadow",children:"Spring Meadow"}),(0,t.jsx)("option",{value:"gradient",children:"Ocean Gradient"}),(0,t.jsx)("option",{value:"nature",children:"Wild Nature"}),(0,t.jsx)("option",{value:"flowers",children:"Flower Garden"}),(0,t.jsx)("option",{value:"animals",children:"Safari Animals"}),(0,t.jsx)("option",{value:"mountains",children:"Snow Mountains"}),(0,t.jsx)("option",{value:"ocean",children:"Deep Ocean"}),(0,t.jsx)("option",{value:"desert",children:"Golden Desert"}),(0,t.jsx)("option",{value:"sunset",children:"Tropical Sunset"}),(0,t.jsx)("option",{value:"aurora",children:"Northern Aurora"}),(0,t.jsx)("option",{value:"galaxy",children:"Starry Galaxy"}),(0,t.jsx)("option",{value:"sakura",children:"Cherry Blossom"}),(0,t.jsx)("option",{value:"autumn",children:"Autumn Leaves"}),(0,t.jsx)("option",{value:"winter",children:"Winter Wonderland"}),(0,t.jsx)("option",{value:"rainbow",children:"Rainbow Sky"}),(0,t.jsx)("option",{value:"zen-garden",children:"Zen Garden"}),(0,t.jsx)("option",{value:"crystal",children:"Crystal Cave"}),(0,t.jsx)("option",{value:"lava",children:"Volcanic Lava"}),(0,t.jsx)("option",{value:"ice",children:"Arctic Ice"}),(0,t.jsx)("option",{value:"cosmic",children:"Cosmic Nebula"}),(0,t.jsx)("option",{value:"ethereal",children:"Ethereal Mist"})]})]})]}),(0,t.jsxs)("div",{className:"settings-section",children:[(0,t.jsx)("h3",{children:"Navigation Bar Background"}),(0,t.jsxs)("div",{className:"setting-item",children:[(0,t.jsx)(u,{}),(0,t.jsxs)("select",{value:H||"default",onChange:e=>Z(e.target.value),children:[(0,t.jsx)("option",{value:"default",children:"Default (Semi-transparent)"}),(0,t.jsx)("option",{value:"glass",children:"Glass Effect"}),(0,t.jsx)("option",{value:"solid",children:"Solid White"}),(0,t.jsx)("option",{value:"gradient",children:"Gradient"}),(0,t.jsx)("option",{value:"blur",children:"Heavy Blur"}),(0,t.jsx)("option",{value:"minimal",children:"Minimal"})]})]})]}),(0,t.jsxs)("div",{className:"settings-section",children:[(0,t.jsx)("h3",{children:"Weather Effects"}),(0,t.jsxs)("div",{className:"setting-item",children:[(0,t.jsx)(p,{}),(0,t.jsxs)("button",{className:"nav-btn ".concat(es?"active":""),onClick:()=>ea(!es),children:[es?"Disable":"Enable"," Weather Effects"]})]})]}),(0,t.jsxs)("div",{className:"settings-section",children:[(0,t.jsx)("h3",{children:"Background Music"}),(0,t.jsxs)("div",{className:"setting-item",children:[(0,t.jsx)(x,{}),(0,t.jsxs)("select",{value:ei,onChange:e=>el(e.target.value),children:[(0,t.jsx)("option",{value:"zen-mixed",children:"Zen Mixed (Waves + Campfire + Rain + Crickets)"}),(0,t.jsx)("option",{value:"zen-forest",children:"Zen Forest"}),(0,t.jsx)("option",{value:"zen-rain",children:"Zen Rain"}),(0,t.jsx)("option",{value:"zen-wind",children:"Zen Wind"}),(0,t.jsx)("option",{value:"zen-birds",children:"Zen Birds"}),(0,t.jsx)("option",{value:"zen-water",children:"Zen Water"}),(0,t.jsx)("option",{value:"meditation",children:"Meditation"}),(0,t.jsx)("option",{value:"flute",children:"Flute"}),(0,t.jsx)("option",{value:"nature",children:"Nature"}),(0,t.jsx)("option",{value:"none",children:"None"})]})]}),(0,t.jsx)("div",{className:"setting-item",children:(0,t.jsxs)("button",{className:"nav-btn ".concat(eo?"active":""),onClick:()=>ed(!eo),children:[eo?"Pause":"Play"," Music"]})})]}),(0,t.jsxs)("div",{className:"settings-section",children:[(0,t.jsx)("h3",{children:"Filters"}),(0,t.jsx)("div",{className:"setting-item",children:(0,t.jsx)("input",{type:"text",placeholder:"Search tasks...",value:A,onChange:e=>O(e.target.value),className:"search-input"})}),(0,t.jsx)("div",{className:"setting-item",children:(0,t.jsxs)("select",{value:K,onChange:e=>W(e.target.value),children:[(0,t.jsx)("option",{value:"All",children:"All Priorities"}),(0,t.jsx)("option",{value:"Low",children:"Low"}),(0,t.jsx)("option",{value:"Medium",children:"Medium"}),(0,t.jsx)("option",{value:"High",children:"High"}),(0,t.jsx)("option",{value:"Important",children:"Important"})]})}),(0,t.jsx)("div",{className:"setting-item",children:(0,t.jsxs)("select",{value:V,onChange:e=>R(e.target.value),children:[(0,t.jsx)("option",{value:"All",children:"All Labels"}),(0,t.jsx)("option",{value:"Math",children:"Math"}),(0,t.jsx)("option",{value:"Physics",children:"Physics"}),(0,t.jsx)("option",{value:"Chemistry",children:"Chemistry"}),(0,t.jsx)("option",{value:"High Priority",children:"High Priority"})]})})]}),(0,t.jsxs)("div",{className:"settings-section",children:[(0,t.jsx)("h3",{children:"Data Management"}),(0,t.jsxs)("div",{className:"setting-item",children:[(0,t.jsx)("button",{className:"nav-btn delete-all-btn",onClick:eI,style:{backgroundColor:"#ef4444",color:"white",border:"none"},title:"Delete all study plan cards from the Kanban board",children:"\uD83D\uDDD1️ Delete All Cards"}),(0,t.jsx)("span",{style:{fontSize:"12px",color:"#666",marginLeft:"10px"},children:"Permanently delete all study plan cards"})]})]})]})]})}),(0,t.jsx)("div",{className:"voice-assistant-container",children:(0,t.jsxs)("button",{className:"voice-assistant-btn",onClick:()=>{},title:"Voice Assistant",children:[(0,t.jsx)("div",{className:"voice-assistant-icon",children:"\uD83C\uDF99️"}),(0,t.jsx)("div",{className:"voice-assistant-pulse"})]})})]})}}},e=>{e.O(0,[701,121,357,636,593,792],()=>e(e.s=2936)),_N_E=e.O()}]);